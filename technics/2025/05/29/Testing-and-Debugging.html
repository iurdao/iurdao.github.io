<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="google-translate-customization" content="108d9124921d80c3-80e20d618ff053c8-g4f02ec6f3dba68b7-c">
<!-- Begin Jekyll SEO tag v2.8.0 -->
<title>PolkaVM’s Testing Arsenal:🚀 From Zero to Bulletproof in Minutes! | Industry-University-Research Dao</title>
<meta name="generator" content="Jekyll v4.4.1">
<meta property="og:title" content="PolkaVM’s Testing Arsenal:🚀 From Zero to Bulletproof in Minutes!">
<meta name="author" content="Joe">
<meta property="og:locale" content="en_US">
<meta name="description" content="This article describes the testing and debugging infrastructure for PolkaVM, including automated test case generation, fuzzing capabilities, and tools for debugging VM execution. For information about benchmarking performance, see Tools and Utilities.">
<meta property="og:description" content="This article describes the testing and debugging infrastructure for PolkaVM, including automated test case generation, fuzzing capabilities, and tools for debugging VM execution. For information about benchmarking performance, see Tools and Utilities.">
<link rel="canonical" href="/technics/2025/05/29/Testing-and-Debugging.html">
<meta property="og:url" content="/technics/2025/05/29/Testing-and-Debugging.html">
<meta property="og:site_name" content="Industry-University-Research Dao">
<meta property="og:type" content="article">
<meta property="article:published_time" content="2025-05-29T00:00:00+00:00">
<meta name="twitter:card" content="summary">
<meta property="twitter:title" content="PolkaVM’s Testing Arsenal:🚀 From Zero to Bulletproof in Minutes!">
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Joe"},"dateModified":"2025-05-29T00:00:00+00:00","datePublished":"2025-05-29T00:00:00+00:00","description":"This article describes the testing and debugging infrastructure for PolkaVM, including automated test case generation, fuzzing capabilities, and tools for debugging VM execution. For information about benchmarking performance, see Tools and Utilities.","headline":"PolkaVM’s Testing Arsenal:🚀 From Zero to Bulletproof in Minutes!","mainEntityOfPage":{"@type":"WebPage","@id":"/technics/2025/05/29/Testing-and-Debugging.html"},"url":"/technics/2025/05/29/Testing-and-Debugging.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="icon" href="">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-noto-sans@0.0.72/index.min.css">
  <link rel="stylesheet" href="/assets/css/main.css">
  <script src="/assets/js/main.js"></script><link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Industry-University-Research Dao">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/default.min.css">
<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js"></script>
<!-- and it's easy to individually load additional languages -->
<script charset="UTF-8" src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/languages/go.min.js"></script>



















<script>
// Init highlight js
document.addEventListener('DOMContentLoaded', function(event) {
  var els = document.querySelectorAll('pre code')

  function addLangData(block) {
    var outer = block.parentElement.parentElement.parentElement;
    var lang = block.getAttribute('data-lang');
    for (var i = 0; i < outer.classList.length; i++) {
      var cls = outer.classList[i];
      if (cls.startsWith('language-')) {
        lang = cls;
        break;
      }
    }
    if (!lang) {
      cls = block.getAttribute('class');
      lang = cls ? cls.replace('hljs ', '') : '';
    }
    if (lang.startsWith('language-')) {
      lang = lang.substr(9);
    }
    block.setAttribute('class', 'hljs ' + lang);
    block.parentNode.setAttribute('data-lang', lang);
  }

  function addBadge(block) {
    var enabled = ('true' || 'true').toLowerCase();
    if (enabled == 'true') {
      var pre = block.parentElement;
      pre.classList.add('badge');
    }
  }

  function handle(block) {
    addLangData(block);
    addBadge(block)
    hljs.highlightBlock(block);
  }

  for (var i = 0; i < els.length; i++) {
    var el = els[i];
    handle(el);
  }
});
</script>

<style>
  /* code language badge */
  pre.badge::before {
    content: attr(data-lang);
    color: #fff;
    background-color: #ff4e00;
    padding: 0 .5em;
    border-radius: 0 2px;
    text-transform: uppercase;
    text-align: center;
    min-width: 32px;
    display: inline-block;
    position: absolute;
    right: 0;
  }

  /* fix wrong badge display for firefox browser */
  code > table pre::before {
    display: none;
  }
</style>
<script src="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.css" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.css" rel="stylesheet">
<style>
  .pswp .pswp__container .pswp__img {
    background-color: white;
  }
</style>

<script>
  function initPhotoSwipe() {
    var mainEl = document.querySelector("section.main");

    var imgEls = mainEl.querySelectorAll("img:not(.emoji)");
    imgEls.forEach((imgEl) => {
      imgEl.outerHTML = `
    <a class="photo-swipe"
      href="${imgEl.src}"
      data-width="${imgEl.getAttribute("width") || imgEl.width * 2}"
      data-height="${imgEl.getAttribute("height") || imgEl.height * 2}"
      data-caption="${imgEl.getAttribute("caption") || imgEl.alt}"
      target="_blank">
      ${imgEl.outerHTML}
    </a>`;
    });

    // Init empty gallery array
    var container = [];

    // Loop over gallery items and push it to the array
    var linkEls = mainEl.querySelectorAll("a.photo-swipe");
    linkEls.forEach((link) => {
      var item = {
        src: link.getAttribute("href"),
        w: link.dataset.width,
        h: link.dataset.height,
        title: link.dataset.caption || "",
      };
      container.push(item);
    });

    // Define click event on gallery item
    linkEls.forEach((link, index) => {
      link.addEventListener("click", (event) => {
        // Prevent location change
        event.preventDefault();

        // Define object and gallery options
        var pswp = document.querySelector(".pswp");

        var zoomLevel = 1;

        // Define object and gallery options
        var options = {
          index: index,
          bgOpacity: 0.85,
          showHideOpacity: true,
          closeOnScroll: true,
          maxSpreadZoom: 1,
          getDoubleTapZoom: (isMouseClick, item) => {
            if (item.detail) {
              zoomLevel += item.detail.origEvent.shiftKey ? -1 : 1;
              item.detail = undefined;
            } else {
              zoomLevel = zoomLevel === 1 ? 2 : 1;
            }
            if (zoomLevel <= 1) {
              zoomLevel = 1;
              setTimeout(() => pswp.classList.remove("pswp--zoomed-in"), 0);
            }
            return item.initialZoomLevel * zoomLevel;
          },
        };

        // Initialize PhotoSwipe
        var gallery = new PhotoSwipe(
          pswp,
          PhotoSwipeUI_Default,
          container,
          options
        );

        gallery.init();

        // Custom zoom event
        gallery.container.addEventListener("pswpTap", (e) => {
          gallery.currItem.detail = e.detail;
        });
      });
    });
  }

  window.addEventListener("load", initPhotoSwipe);
</script>

<!-- Root element of PhotoSwipe. Must have class pswp. -->
</head>
<body>
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">
  <!-- Background of PhotoSwipe.
           It's a separate element as animating opacity is faster than rgba(). -->
  <div class="pswp__bg"></div>
  <!-- Slides wrapper with overflow:hidden. -->
  <div class="pswp__scroll-wrap">
    <!-- Container that holds slides.
              PhotoSwipe keeps only 3 of them in the DOM to save memory.
              Don't modify these 3 pswp__item elements, data is added later on. -->
    <div class="pswp__container">
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
      <div class="pswp__item"></div>
    </div>
    <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
    <div class="pswp__ui pswp__ui--hidden">
      <div class="pswp__top-bar">
        <!--  Controls are self-explanatory. Order can be changed. -->
        <div class="pswp__counter"></div>
        <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
        <button class="pswp__button pswp__button--share" title="Share"></button>
        <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
        <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
        <!-- element will get class pswp__preloader--active when preloader is running -->
        <div class="pswp__preloader">
          <div class="pswp__preloader__icn">
            <div class="pswp__preloader__cut">
              <div class="pswp__preloader__donut"></div>
            </div>
          </div>
        </div>
      </div>
      <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
        <div class="pswp__share-tooltip"></div>
      </div>
      <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
      <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button>
      <div class="pswp__caption">
        <div class="pswp__caption__center"></div>
      </div>
    </div>
  </div>
</div>





























































































































<header class="site-header " role="banner">

  <div class="wrapper">
    <div class="site-header-inner">
<span class="site-brand"><a class="site-brand-inner" rel="author" href="/">
  <img class="site-favicon" title="Industry-University-Research Dao" src="" onerror="this.style.display='none'">
  Industry-University-Research Dao
</a>
</span><nav class="site-nav">
          <input type="checkbox" id="nav-trigger" class="nav-trigger">
          <label for="nav-trigger">
            <span class="menu-icon">
              <svg viewbox="0 0 18 15" width="18px" height="15px">
                <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"></path>
              </svg>
            </span>
          </label>

          <div class="trigger">
<a class="page-link" href="/about.html">ABOUT</a><a class="page-link" href="/archives.html">ARCHIVES</a><a class="page-link" href="/categories.html">CATEGORIES</a><a class="page-link" href="/">HOME</a><a class="page-link" href="/tags.html">TAGS</a>









<span class="page-link">



<div id="google_translate_element" style="display: none;">
</div>

<span class="ct-language">
  <ul class="list-unstyled ct-language-dropdown">
    
      <li>
        <a href="#" class="lang-select" data-lang="en">
          
          <img src="https://cdn.countryflags.com/thumbs/united-states-of-america/flag-400.png" title="English">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="fr">
          
          <img src="https://cdn.countryflags.com/thumbs/france/flag-400.png" title="French">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="zh-CN">
          
          <img src="https://cdn.countryflags.com/thumbs/china/flag-400.png" title="Chinese(Simple)">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ja">
          
          <img src="https://cdn.countryflags.com/thumbs/japan/flag-400.png" title="Japanese">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ko">
          
          <img src="https://cdn.countryflags.com/thumbs/south-korea/flag-400.png" title="Korean">
          
        </a>
      </li>
    
      <li>
        <a href="#" class="lang-select" data-lang="ru">
          
          <img src="https://cdn.countryflags.com/thumbs/russia/flag-400.png" title="Russian">
          
        </a>
      </li>
    
  </ul>
</span>

<script type="text/javascript">
function googleTranslateElementInit() {
  new google.translate.TranslateElement({
    pageLanguage: 'en',
    autoDisplay: false,
    layout: google.translate.TranslateElement.InlineLayout.VERTICAL
  }, 'google_translate_element');

  // Links to cross-origin destinations are unsafe
  var gll = document.getElementsByClassName('goog-logo-link')[0];
  if (gll) {
    gll.setAttribute('rel', 'noopener');
  }

  function restoreLang() {
    var iframe = document.getElementsByClassName('goog-te-banner-frame')[0];
    if (!iframe) return;

    var innerDoc = iframe.contentDocument || iframe.contentWindow.document;
    var restore_el = innerDoc.getElementsByTagName("button");

    for (var i = 0; i < restore_el.length; i++) {
      if (restore_el[i].id.indexOf("restore") >= 0) {
        restore_el[i].click();
        var close_el = innerDoc.getElementsByClassName("goog-close-link");
        close_el[0].click();
        return;
      }
    }
  }

  function triggerHtmlEvent(element, eventName) {
    var event;
    if (document.createEvent) {
      event = document.createEvent('HTMLEvents');
      event.initEvent(eventName, true, true);
      element.dispatchEvent(event);
    } else {
      event = document.createEventObject();
      event.eventType = eventName;
      element.fireEvent('on' + event.eventType, event);
    }
  }

  var googleCombo = document.querySelector("select.goog-te-combo");
  var langSelect = document.querySelector('.ct-language');
  langSelect.addEventListener('click', function(event) {
    if (!event.target) {
      return;
    }

    var selected = document.querySelector('.ct-language .ct-language-selected');
    if (selected) {
      selected.classList.remove('ct-language-selected');
    }

    var target = event.target;
    while (target && target !== langSelect ) {
      if (target.matches('.lang-select')) {
        break;
      }
      target = target.parentElement;
    }

    if (target && target.matches('.lang-select')) {
      var lang = target.getAttribute('data-lang');
      if (googleCombo.value == lang) {
        restoreLang();
      } else {
        target.parentElement.classList.add('ct-language-selected');
        googleCombo.value = lang;
        triggerHtmlEvent(googleCombo, 'change');
      }
    }

    event.preventDefault();
  });
}
</script>

<script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
</span>
</div>
        </nav>
</div>
  </div>
</header>

<script>
  function initHeader() {
    var lastScrollY = getScrollPos().y;
    var documentElement = document.documentElement;

    function storeScrollData() {
      var y = getScrollPos().y;var scrollStatus = "";

      if (y <= 0) {
        scrollStatus = "top";
      } else if ((window.innerHeight + y) >= document.body.offsetHeight) {
        scrollStatus = "bottom";
      } else {
        var isScrollDown = (y - lastScrollY > 0) ? true : false;
        scrollStatus = isScrollDown ? "down" : "up";
      }

      lastScrollY = y;
      documentElement.setAttribute("data-scroll-status", scrollStatus);
    }

    window.addEventListener('scroll', function(e) {
      storeScrollData();
    });

    storeScrollData();
  }
  document.addEventListener('DOMContentLoaded', initHeader);
</script>
















































































































































<script>
  function hashLocate(hashValue) {
    hashValue = hashValue.replace(/^.*#h-/, '');
    hashValue = decodeURIComponent(hashValue);
    var element = document.getElementById(hashValue);

    if (!element) {
      return;
    }

    var header = document.querySelector('header.site-header');
    var headerRect = header.getBoundingClientRect();
    var headerTop = Math.floor(headerRect.top);
    var headerHeight = Math.floor(headerRect.height);
    var scrollPos = getScrollPos();
    var offsetY = element.offsetTop - (headerTop + headerHeight + 20);

    if (offsetY == scrollPos.y) {
      return;
    }

    if (headerTop == 0  && offsetY > scrollPos.y) {
      offsetY += headerHeight + 2;
    } else if (headerTop < 0  && offsetY < scrollPos.y) {
      offsetY -= headerHeight - 2;
    }

    smoothScrollTo(offsetY);
  }

  // The first event occurred
  window.addEventListener('load', function(event) {
    if (window.location.hash) {
      hashLocate(window.location.hash);
    }
  });

  // The first event occurred
  window.addEventListener('click', function(event) {
    if (event.target.tagName.toLowerCase() == 'a') {
      hashLocate(event.target.getAttribute('href'));
    }
  });
</script>
<div class="theme-toggle">
  <input type="checkbox" id="theme-switch">
  <label for="theme-switch">
    <div class="toggle"></div>
    <div class="names">
      <p class="light">Light</p>
      <p class="dark">Dark</p>
    </div>
  </label>
</div>




<script>
  (function() {
    var sw = document.getElementById('theme-switch');
    var html = document.getElementsByTagName('html')[0];
    var nightModeOption = ('auto' || 'auto').toLowerCase();
    var storage = nightModeOption === 'manual'
        ? localStorage
        : sessionStorage;
    var themeData = loadThemeData();

    function saveThemeData(data) {
      storage.setItem('theme', JSON.stringify(data));
    }

    function loadThemeData() {
      var data = storage.getItem('theme');
      try {
        data = JSON.parse(data ? data : '');
      } catch(e) {
        data = { nightShift: undefined, autoToggleAt: 0 };
        saveThemeData(data);
      }
      return data;
    }

    function handleThemeToggle(nightShift) {
      themeData.nightShift = nightShift;
      saveThemeData(themeData);
      html.dataset.theme = nightShift ? 'dark' : 'light';
      setTimeout(function() {
        sw.checked = nightShift ? true : false;
      }, 50);
    }

    function autoThemeToggle() {
      // Next time point of theme toggle
      var now = new Date();
      var toggleAt = new Date();
      var hours = now.getHours();
      var nightShift = hours >= 19 || hours <=7;

      if (nightShift) {
        if (hours > 7) {
          toggleAt.setDate(toggleAt.getDate() + 1);
        }
        toggleAt.setHours(7);
      } else {
        toggleAt.setHours(19);
      }

      toggleAt.setMinutes(0);
      toggleAt.setSeconds(0);
      toggleAt.setMilliseconds(0)

      var delay = toggleAt.getTime() - now.getTime();

      // auto toggle theme mode
      setTimeout(function() {
        handleThemeToggle(!nightShift);
      }, delay);

      return {
        nightShift: nightShift,
        toggleAt: toggleAt.getTime()
      };
    }

    // Listen the theme toggle event
    sw.addEventListener('change', function(event) {
      handleThemeToggle(event.target.checked);
    });

    if (nightModeOption == 'auto') {
      var data = autoThemeToggle();

      // Toggle theme by local setting
      if (data.toggleAt > themeData.autoToggleAt) {
        themeData.autoToggleAt = data.toggleAt;
        handleThemeToggle(data.nightShift);
      } else {
        handleThemeToggle(themeData.nightShift);
      }
    } else if (nightModeOption == 'manual') {
      handleThemeToggle(themeData.nightShift);
    } else {
      var nightShift = themeData.nightShift;
      if (nightShift === undefined) {
        nightShift = nightModeOption === 'on';
      }
      handleThemeToggle(nightShift);
    }
  })();
</script>
<div id="click-to-top" class="click-to-top">
  <i class="fa fa-arrow-up"></i>
</div>
<script>
  (function () {
    const clickToTop = document.getElementById('click-to-top');
    window.addEventListener('scroll', () => {
      if (window.scrollY > 100) {
        clickToTop.classList.add('show')
      }else {
        clickToTop.classList.remove('show')
      }
    });
    clickToTop.addEventListener('click', () => {
      window.smoothScrollTo(0);
    });
  })();
</script>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <div class="framework">
  <section class="main">

     <div class="post">
  <section>









<header class="post-header">
  <h1 class="post-title p-name" itemprop="name headline">PolkaVM's Testing Arsenal:🚀 From Zero to Bulletproof in Minutes!</h1>
  <h2 class="post-subtitle">Automated test case generation, fuzzing, and cross-VM validation – learn how to build unshakeable applications.</h2>

  <p class="post-meta">
    <time class="dt-published" datetime="2025-05-29T00:00:00+00:00" itemprop="datePublished"><i class="fa fa-calendar"></i> May 29, 2025
    </time>

    
    
































    <span class="post-reading-time left-vsplit"><i class="fa fa-clock-o"></i> About 5 mins</span>
  </p>
<div class="post-tags">
<a class="post-tag" href="/tags.html#PolkaVM">#PolkaVM</a><a class="post-tag" href="/tags.html#Testing">#Testing</a><a class="post-tag" href="/tags.html#Debugging">#Debugging</a>
</div></header>
<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

    <div class="post-content e-content" itemprop="articleBody">

      <p>This article describes the testing and debugging infrastructure for PolkaVM, including automated test case generation, fuzzing capabilities, and tools for debugging VM execution. For information about benchmarking performance, see <a href="https://iurdao.github.io/technics/2025/05/28/Tools-and-Utilities.html">Tools and Utilities</a>.</p>

<h2 id="test-specification-infrastructure">Test Specification Infrastructure</h2>

<p>PolkaVM employs a comprehensive test specification framework that allows for defining test cases with precise initial conditions and expected outcomes. This infrastructure is primarily implemented via the <code class="language-plaintext highlighter-rouge">spectool</code> utility.</p>

<h3 id="test-case-schema">Test Case Schema</h3>

<p>Test cases are defined using a structured schema that specifies:</p>

<ul>
  <li>Initial VM state (registers, memory, gas)</li>
  <li>Program to execute</li>
  <li>Expected final state after execution</li>
  <li>Expected execution status (halt, trap, page fault)</li>
</ul>

<p>The schema is formally defined in both ASN.1 and JSON Schema formats:</p>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoiJSUtXG5jbGFzc0RpYWdyYW1cbmNsYXNzIFRlc3RjYXNle1xubmFtZTogc3RyaW5nXG5pbml0aWFsX3JlZ3M6IHU2NFsxM11cbmluaXRpYWxfcGM6IHUzMlxuaW5pdGlhbF9wYWdlX21hcDogUGFnZVtdXG5pbml0aWFsX21lbW9yeTogTWVtb3J5Q2h1bmtbXVxuaW5pdGlhbF9nYXM6IGk2NFxucHJvZ3JhbTogdThbXVxuZXhwZWN0ZWRfc3RhdHVzOiBzdHJpbmdcbmV4cGVjdGVkX3JlZ3M6IHU2NFsxM11cbmV4cGVjdGVkX3BjOiB1MzJcbmV4cGVjdGVkX21lbW9yeTogTWVtb3J5Q2h1bmtbXVxuZXhwZWN0ZWRfZ2FzOiBpNjRcbmV4cGVjdGVkX3BhZ2VfZmF1bHRfYWRkcmVzcz86IHUzMlxufVxuY2xhc3MgUGFnZXtcbmFkZHJlc3M6IHUzMlxubGVuZ3RoOiB1MzJcbmlzX3dyaXRhYmxlOiBib29sZWFuXG59XG5jbGFzcyBNZW1vcnlDaHVua3tcbmFkZHJlc3M6IHUzMlxuY29udGVudHM6IHU4W11cbn1cblRlc3RjYXNlIC0tPiBQYWdlOmNvbnRhaW5zXG5UZXN0Y2FzZSAtLT4gTWVtb3J5Q2h1bms6Y29udGFpbnNcbiUlLSIsIm1lcm1haWQiOm51bGx9"></p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/spec/schema.json#L1-L98">tools/spectool/spec/schema.json1-98</a> <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/spec/schema.asn#L1-L87">tools/spectool/spec/schema.asn1-87</a></p>

<h3 id="test-case-generation">Test Case Generation</h3>

<p>The <code class="language-plaintext highlighter-rouge">spectool generate</code> command creates test cases by:</p>

<ol>
  <li>Loading assembly code or ELF files</li>
  <li>Assembling them into program blobs</li>
  <li>Executing them in a controlled environment</li>
  <li>Recording state changes during execution</li>
  <li>Generating JSON test case files</li>
  <li>Creating a human-readable index (TESTCASES.md)</li>
</ol>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L137-L608">tools/spectool/src/main.rs137-608</a></p>

<h3 id="prepost-directives">Pre/Post Directives</h3>

<p>Test assembly files can include special directives to specify assertions about the initial and expected state:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pre: r1 = 42      # Set register r1 to 42 before execution
pre: gas = 10000  # Set initial gas to 10000

post: r2 = 84     # Expect register r2 to be 84 after execution
post: pc = @label[2] # Expect program counter to be at offset 2 from label

</code></pre></div></div>

<p>These directives are processed when generating test cases and verified during test execution.</p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L97-L134">tools/spectool/src/main.rs97-134</a> <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L173-L186">tools/spectool/src/main.rs173-186</a></p>

<h2 id="fuzzing-infrastructure">Fuzzing Infrastructure</h2>

<p>PolkaVM uses LibFuzzer to perform structured fuzzing of various components. Fuzzing helps find edge cases, vulnerabilities, and correctness issues by generating random but valid inputs.</p>

<h3 id="fuzz-targets">Fuzz Targets</h3>

<p>The project includes several fuzzing targets:</p>

<table>
  <thead>
    <tr>
      <th>Target</th>
      <th>Purpose</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fuzz_shm_allocator</code></td>
      <td>Tests the shared memory allocator</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fuzz_generic_allocator</code></td>
      <td>Tests the generic allocator</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fuzz_linker</code></td>
      <td>Tests the linker by generating random RISC-V instructions</td>
    </tr>
    <tr>
      <td><code class="language-plaintext highlighter-rouge">fuzz_polkavm</code></td>
      <td>Tests VM execution with randomly generated operations</td>
    </tr>
  </tbody>
</table>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/fuzz/Cargo.toml#L24-L50">fuzz/Cargo.toml24-50</a></p>

<h3 id="vm-execution-fuzzing">VM Execution Fuzzing</h3>

<p>The <code class="language-plaintext highlighter-rouge">fuzz_polkavm</code> target is particularly important as it tests the VM execution correctness by:</p>

<ol>
  <li>Generating random, but valid VM instructions</li>
  <li>Building a program blob from these instructions</li>
  <li>Executing the program in both interpreter and compiler backends</li>
  <li>Comparing results to ensure identical behavior</li>
</ol>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoiJSUtXG5mbG93Y2hhcnQgVERcbnN1YmdyYXBoIENvbXBhcmVkIFN0YXRlXG5BW0ludGVycnVwdCBLaW5kXVxuQltQcm9ncmFtIENvdW50ZXJdXG5DW1JlZ2lzdGVyIFZhbHVlc11cbmVuZFxuRFtSYW5kb20gT3BlcmF0aW9uc10tLT5FW0J1aWxkIFByb2dyYW0gQmxvYl1cbkUtLT5GW0V4ZWN1dGUgaW4gSW50ZXJwcmV0ZXJdXG5FLS0-R1tFeGVjdXRlIGluIENvbXBpbGVyXVxuRi0tPkhbQ29tcGFyZSBSZXN1bHRzXVxuRy0tPkhcbkgtLT58TWF0Y2h8SVtTdWNjZXNzXVxuSC0tPnxNaXNtYXRjaHxKW1wiRmFpbHVyZSAoQnVnIEZvdW5kKVwiXVxuJSUtIiwibWVybWFpZCI6bnVsbH0"></p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/fuzz/fuzz_targets/fuzz_polkavm.rs#L539-L617">fuzz/fuzz_targets/fuzz_polkavm.rs539-617</a></p>

<h3 id="linker-fuzzing">Linker Fuzzing</h3>

<p>The <code class="language-plaintext highlighter-rouge">fuzz_linker</code> target tests the linker by:</p>

<ol>
  <li>Generating random, but valid RISC-V instructions</li>
  <li>Creating a minimal ELF file with these instructions</li>
  <li>Passing the ELF file to the linker</li>
  <li>Verifying that the linker processes it without crashing</li>
</ol>

<p>This helps identify potential issues in the instruction transformation and optimization pipeline.</p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/fuzz/fuzz_targets/fuzz_linker.rs#L239-L248">fuzz/fuzz_targets/fuzz_linker.rs239-248</a></p>

<h2 id="debugging-capabilities">Debugging Capabilities</h2>

<h3 id="step-tracing">Step Tracing</h3>

<p>PolkaVM supports step-by-step execution tracing via the <code class="language-plaintext highlighter-rouge">step_tracing</code> option in <code class="language-plaintext highlighter-rouge">ModuleConfig</code>. When enabled, the VM generates <code class="language-plaintext highlighter-rouge">InterruptKind::Step</code> after executing each instruction, allowing for detailed execution analysis.</p>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoiJSUtXG5zZXF1ZW5jZURpYWdyYW1cbnBhcnRpY2lwYW50IEEgYXMgSG9zdCBQcm9ncmFtXG5wYXJ0aWNpcGFudCBCIGFzIFBvbGthVk1cbnBhcnRpY2lwYW50IEMgYXMgR3Vlc3QgUHJvZ3JhbVxuJSUtXG5BIC0-PkI6IHNldF9zdGVwX3RyYWNpbmcodHJ1ZSlcbkEgLT4-QjogcnVuKClcbkIgLT4-QzogZXhlY3V0ZSBpbnN0cnVjdGlvblxuQiAtLT4-QTogSW50ZXJydXB0S2luZDo6U3RlcFxuQSAtPj5COiBpbnNwZWN0IHN0YXRlXG5BIC0-PkI6IHJ1bigpXG5CIC0-PkM6IGV4ZWN1dGUgbmV4dCBpbnN0cnVjdGlvblxuQiAtLT4-QTogSW50ZXJydXB0S2luZDo6U3RlcFxuQSAtPj5COiBpbnNwZWN0IHN0YXRlXG5Ob3RlIG92ZXIgQSxDIDogUmVwZWF0IHVudGlsIHByb2dyYW0gY29tcGxldGVzXG4lJS0iLCJtZXJtYWlkIjpudWxsfQ"></p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L274-L274">tools/spectool/src/main.rs274</a></p>

<h3 id="disassembly">Disassembly</h3>

<p>The PolkaVM disassembler provides tools to convert program blobs back to human-readable assembly code. The disassembler supports various options:</p>

<ul>
  <li>Showing raw instruction bytes</li>
  <li>Using different register naming conventions</li>
  <li>Showing original or optimized instructions</li>
  <li>Displaying jump targets as offsets or labels</li>
</ul>

<p>This is useful for debugging VM behavior and verifying code transformations.</p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L427-L438">tools/spectool/src/main.rs427-438</a></p>

<h3 id="memory-inspection">Memory Inspection</h3>

<p>The VM provides APIs to inspect and modify memory during execution:</p>

<ul>
  <li>
<code class="language-plaintext highlighter-rouge">read_memory</code> - Read contents from guest memory</li>
  <li>
<code class="language-plaintext highlighter-rouge">write_memory</code> - Write data to guest memory</li>
  <li>
<code class="language-plaintext highlighter-rouge">zero_memory</code> - Initialize memory regions with zeros</li>
  <li>
<code class="language-plaintext highlighter-rouge">protect_memory</code> - Mark memory as read-only</li>
</ul>

<p>These functions are useful for setting up test cases and inspecting execution results.</p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L347-L355">tools/spectool/src/main.rs347-355</a> <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L398-L401">tools/spectool/src/main.rs398-401</a></p>

<h2 id="correctness-testing">Correctness Testing</h2>

<p>PolkaVM employs various strategies to ensure correctness:</p>

<h3 id="backend-consistency-testing">Backend Consistency Testing</h3>

<p>The fuzzing infrastructure includes a cross-backend verification mode that:</p>

<ol>
  <li>Executes the same program in both interpreter and compiler backends</li>
  <li>Compares final state (registers, memory, program counter)</li>
  <li>Verifies consistent interrupt behavior</li>
  <li>Reports any discrepancies as bugs</li>
</ol>

<p>This ensures that both execution backends implement the same semantics.</p>

<p><img class="mermaid" src="https://mermaid.ink/svg/eyJjb2RlIjoiJSUtXG5mbG93Y2hhcnQgVERcbnN1YmdyYXBoIFZlcmlmaWNhdGlvbiBQb2ludHNcbkFbUmVnaXN0ZXJzXVxuQltQcm9ncmFtIENvdW50ZXJdXG5DW0ludGVycnVwdCBLaW5kXVxuWltNZW1vcnkgU3RhdGVdXG5lbmRcbkRbVGVzdCBQcm9ncmFtXS0tPkVbRXhlY3V0ZSB3aXRoIEludGVycHJldGVyXVxuRC0tPkZbRXhlY3V0ZSB3aXRoIENvbXBpbGVyXVxuRS0tPkd7Q29tcGFyZSBSZXN1bHRzfVxuRi0tPkdcbkctLT58TWF0Y2h8SFtQYXNzXVxuRy0tPnxNaXNtYXRjaHxJW0ZhaWxdXG4lJS0iLCJtZXJtYWlkIjpudWxsfQ"></p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/fuzz/fuzz_targets/fuzz_polkavm.rs#L584-L601">fuzz/fuzz_targets/fuzz_polkavm.rs584-601</a></p>

<h3 id="risc-v-tests">RISC-V Tests</h3>

<p>PolkaVM includes tests that verify compatibility with standard RISC-V test suites. These tests are included in the test case generation process:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// Extract RISC-V tests from the built-in test suite for line in include_str!("../../../crates/polkavm/src/tests_riscv.rs").lines() {  let prefix = "riscv_test!(riscv_unoptimized_rv64";  if !line.starts_with(prefix) {  continue;     }
 // Process test... }
</code></pre></div></div>

<p>These tests help ensure conformance to the RISC-V specification.</p>

<p>Sources: <a href="https://github.com/paritytech/polkavm/blob/910adbda/tools/spectool/src/main.rs#L209-L251">tools/spectool/src/main.rs209-251</a></p>

<h2 id="testing-workflow">Testing Workflow</h2>

<p>Here’s an overview of the recommended testing workflow for PolkaVM development:</p>

<ol>
  <li>
<strong>Unit Tests</strong>: Run the standard Rust test suite with <code class="language-plaintext highlighter-rouge">cargo test</code>
</li>
  <li>
<strong>Spec Tests</strong>: Generate and run specification tests with <code class="language-plaintext highlighter-rouge">spectool generate</code> and <code class="language-plaintext highlighter-rouge">spectool test</code>
</li>
  <li>
<strong>Fuzzing</strong>: Run fuzzing targets to find edge cases and bugs</li>
  <li>
<strong>Cross-VM Testing</strong>: Compare results with other RISC-V VMs using <code class="language-plaintext highlighter-rouge">benchtool</code>
</li>
</ol>

<p>For continuous testing during development, consider setting up automated test pipelines that include all these components.</p>


    </div>

</article>
<div class="post-nav">
<a class="previous" href="/technics/2025/05/28/Tools-and-Utilities.html" title="Level Up Your PolkaVM Game! 🛠️ The Essential Command-Line Tools You NEED to Know.">Level Up Your PolkaVM Game! 🛠️...</a><a class="next" href="/technics/2025/06/15/PolkaVM-Doom-Example-Program-Analysis.html" title="PolkaVM Doom Example Program Analysis">PolkaVM Doom Example Program Analysis</a>
</div>
<div class="post-related">
      <div>Related Articles</div>
      <ul>
        <li><a class="post-link" href="/technics/2025/05/25/Unveiling-PolkaVMs-Secrets-How-Programs-Really-Work.html" title="PolkaVM Doom Example Program Analysis">Unveiling PolkaVM's Secrets:How Programs Really Work ⚙️</a></li>
<li><a class="post-link" href="/technics/2025/05/26/Guest-Programs.html" title="PolkaVM Doom Example Program Analysis">Beyond WASM:The Future is RISC-V with PolkaVM Guest Programs ✨</a></li>
<li><a class="post-link" href="/technics/2025/05/24/Inside-PolkaVM-Unveiling-the-Core-VM-Engine.html" title="PolkaVM Doom Example Program Analysis">Inside PolkaVM - Unveiling the Core VM Engine</a></li>
<li><a class="post-link" href="/technics/2025/05/24/Unlock-Untrusted-Code.html" title="PolkaVM Doom Example Program Analysis">Unlock Untrusted Code - PolkaVM's Architecture Deep Dive</a></li>
</ul>
    </div>
<div class="post-comments"></div></section>
</div>


  </section>
  <section class="sidebar" style="margin-left: 15px;">
    <!-- Get sidebar items --><style type="text/css" media="screen">
.post-menu ul {
  list-style: none;
  padding: 0;
  margin: 0;
}
</style>

<div class="post-menu">
  <div class="post-menu-title">TOC</div>
  <div class="post-menu-content"></div>
</div>

<script>
  function generateContent() {
    var menu = document.querySelector(".post-menu");
    var menuContent =  menu.querySelector(".post-menu-content");
    var headings = document.querySelector(".post-content").querySelectorAll("h2, h3, h4, h5, h6");

    // Hide menu when no headings
    if (headings.length === 0) {
      return menu.style.display = "none";
    }

    // Generate post menu
    var menuHTML = '';
    for (var i = 0; i < headings.length; i++) {
      var h = headings[i];
      menuHTML += (
        '<li class="h-' + h.tagName.toLowerCase() + '">'
        + '<a href="#h-' + h.getAttribute('id') + '">' + h.textContent + '</a></li>');
    }

    menuContent.innerHTML = '<ul>' + menuHTML + '</ul>';

    // The header element
    var header = document.querySelector('header.site-header');

    function doMenuCollapse(index, over_items) {
      var items = menuContent.firstChild.children;

      if (over_items == undefined) {
        over_items = 20;
      }

      if (items.length < over_items) {
        return;
      }

      var activeItem = items[index];
      var beginItem = activeItem
      var endItem = activeItem
      var beginIndex = index;
      var endIndex = index + 1;
      while (beginIndex >= 0
        && !items[beginIndex].classList.contains('h-h2')) {
        beginIndex -= 1;
      }
      while (endIndex < items.length
        && !items[endIndex].classList.contains('h-h2')) {
        endIndex += 1;
      }
      for (var i = 0; i < beginIndex; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
      for (var i = beginIndex + 1; i < endIndex; i++) {
        item = items[i]
        // if (!item.classList.contains('h-h2')) {
          item.style.display = '';
        // }
      }
      for (var i = endIndex; i < items.length; i++) {
        item = items[i]
        if (!item.classList.contains('h-h2')) {
          item.style.display = 'none';
        }
      }
    }

    // Init menu collapsed
    doMenuCollapse(-1);

    // Active the menu item
    window.addEventListener('scroll', function (event) {
      var lastActive = menuContent.querySelector('.active');
      var changed = true;
      var activeIndex = -1;
      for (var i = headings.length - 1; i >= 0; i--) {
        var h = headings[i];
        var headingRect = h.getBoundingClientRect();
        var headerRect = header.getBoundingClientRect();
        var headerTop = Math.floor(headerRect.top);
        var headerHeight = Math.floor(headerRect.height);
        var headerHeight = headerTop + headerHeight + 20;
        if (headingRect.top <= headerHeight) {
          var id = 'h-' + h.getAttribute('id');
          var a = menuContent.querySelector('a[href="#' + id  + '"]');
          var curActive = a.parentNode;
          if (curActive) {
            curActive.classList.add('active');
            activeIndex = i;
          }
          if (lastActive == curActive) {
            changed = false;
          }
          break;
        }
      }
      if (changed) {
        if (lastActive) {
          lastActive.classList.remove('active');
        }
        doMenuCollapse(activeIndex);
      }
      event.preventDefault();
    });
  }
  generateContent();
</script>
</section>
</div>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">
    <div class="site-footer-inner">
<div>IURDao 2017-2025 Joe</div>
      <div class="footer-col rss-subscribe">Subscribe <a href="/feed.xml">via RSS</a>
</div>
    </div>
  </div>
</footer>

</body>
</html>
